name: Publish

on: 
  release: 
    types: [published]

jobs:

  ci:
    name: CI Job
    uses: ./.github/workflows/ci.yml

  publish:
    name: Publish To Marketplace
    runs-on: ubuntu-latest
    needs: [ci]
    permissions: 
      contents: write
    steps:
      - name: Configure git
        run: |
          git config --global user.email "github-actions[bot]@users.noreply.github.com"
          git config --global user.name "github-actions[bot]"
      - name: Publish Action
        uses: github-actions-publish/publish-action@v1
        with:
          tag: v1